<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: header"></head>
<body>
<div class="container mt-5">
    <h2>Forgot Password</h2>

    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
    <div th:if="${message}" class="alert alert-success" th:text="${message}"></div>

    <!-- Stage 1: ask email -->
    <form th:if="${stage} == null" th:action="@{/auth/forgot-password/send-otp}" method="post">
        <input name="email" class="form-control mb-3" placeholder="Your Email" required>
        <button class="btn btn-primary w-100">Send OTP</button>
    </form>

    <!-- Stage 2: verify otp -->
    <form th:if="${stage} == 'otp'" th:action="@{/auth/forgot-password/verify-otp}" method="post">
        <input type="hidden" name="email" th:value="${email}">
        <input name="otp" class="form-control mb-3" placeholder="Enter OTP" required>
        <button class="btn btn-primary w-100">Verify OTP</button>
    </form>

    <!-- Stage 3: reset password -->
    <form th:if="${stage} == 'reset'" th:action="@{/auth/forgot-password/reset}" method="post">
        <input type="hidden" name="email" th:value="${email}">
        <input name="password" type="password" class="form-control mb-3" placeholder="New Password" required>
        <button class="btn btn-success w-100">Reset Password</button>
    </form>
</div>
<div th:replace="fragments/footer :: footer"></div>
</body>
</html>
